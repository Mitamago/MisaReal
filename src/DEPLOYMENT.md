# Vercelデプロイガイド

## 概要
このアプリはVercelを使用してインターネット上にデプロイされます。VercelはServerless Functionsを提供し、自動スケーリングとCDN配信をサポートします。

## デプロイ手順

### 1. Vercelアカウントの準備

#### Vercelアカウントの作成
1. [Vercel](https://vercel.com)にアクセス
2. 「Sign Up」をクリック
3. GitHubアカウントでサインアップ（推奨）

#### GitHubリポジトリの準備
1. コードをGitHubリポジトリにプッシュ
2. リポジトリが公開されていることを確認（プライベートでも可）

### 2. プロジェクトのインポート

#### 新しいプロジェクトの作成
1. Vercelダッシュボードで「New Project」をクリック
2. GitHubリポジトリを選択
3. プロジェクト設定を入力：
   - **Project Name**: `ima-nani-shiteru`（任意の名前）
   - **Framework Preset**: `Other`
   - **Root Directory**: `src`
   - **Build Command**: `npm run build`
   - **Output Directory**: `src`
   - **Install Command**: `npm install`

#### 環境変数の設定
現在は環境変数は不要ですが、将来的にデータベース接続などで必要になる場合があります。

### 3. デプロイの実行

#### 初回デプロイ
1. 「Deploy」ボタンをクリック
2. デプロイが完了するまで待機（通常1-2分）
3. 提供されたURLでアプリにアクセス

#### デプロイの確認
- 提供されたURL（例：`https://ima-nani-shiteru.vercel.app`）にアクセス
- ログイン機能が動作することを確認
- 投稿機能が動作することを確認
- 複数のブラウザでテスト

## 自動デプロイの設定

### GitHub連携
- `main`ブランチへのプッシュで自動デプロイ
- プルリクエストはプレビュー環境としてデプロイ
- デプロイ履歴はVercelダッシュボードで確認可能

### デプロイのトリガー
```bash
# コードを変更後、GitHubにプッシュ
git add .
git commit -m "機能追加"
git push origin main
```

## 本番環境の管理

### ドメインの設定
1. Vercelダッシュボードでプロジェクトを選択
2. 「Settings」→「Domains」をクリック
3. カスタムドメインを追加（オプション）

### 環境変数の管理
1. 「Settings」→「Environment Variables」をクリック
2. 必要な環境変数を追加
3. 本番環境とプレビュー環境で分けて設定可能

### ログの確認
1. 「Functions」タブをクリック
2. API呼び出しのログを確認
3. エラーが発生した場合は詳細を確認

## パフォーマンス最適化

### CDN配信
- Vercelは自動的にCDNを使用
- 静的ファイルは世界中のエッジサーバーから配信

### Serverless Functions
- APIは必要に応じて自動スケーリング
- 使用量に応じて課金

### キャッシュ設定
- ブラウザキャッシュは自動設定
- APIレスポンスのキャッシュは必要に応じて設定

## 監視とアラート

### パフォーマンス監視
1. 「Analytics」タブでアクセス統計を確認
2. ページビュー、ユニークユーザー数を確認
3. パフォーマンスメトリクスを確認

### エラー監視
1. 「Functions」タブでエラーログを確認
2. エラー率が高い場合は調査
3. 必要に応じてアラートを設定

## バックアップと復元

### コードのバックアップ
- GitHubリポジトリが自動バックアップ
- 定期的にローカルにもバックアップ

### データのバックアップ
- 現在はメモリベースのため、サーバー再起動でデータが失われる
- 将来的にデータベース導入時は自動バックアップを設定

## トラブルシューティング

### デプロイが失敗する場合
1. **ビルドエラーの確認**
   - Vercelダッシュボードの「Deployments」タブでエラーを確認
   - ローカルで `npm run build` が成功することを確認

2. **依存関係の問題**
   - `package.json`の依存関係を確認
   - Node.jsのバージョンが18.0.0以上であることを確認

3. **設定ファイルの問題**
   - `vercel.json`の設定を確認
   - Root Directoryが `src` に設定されていることを確認

### APIが動作しない場合
1. **関数の確認**
   - 「Functions」タブでAPI関数が正しくデプロイされているか確認
   - エラーログを確認

2. **CORS設定の確認**
   - APIファイルでCORS設定が正しいことを確認
   - ブラウザの開発者ツールでエラーを確認

### パフォーマンスの問題
1. **レスポンス時間の確認**
   - 「Analytics」タブでパフォーマンスメトリクスを確認
   - 特定の地域で遅い場合はCDNの影響

2. **メモリ使用量の確認**
   - 「Functions」タブでメモリ使用量を確認
   - 必要に応じてメモリ制限を調整

## セキュリティ考慮事項

### HTTPS
- Vercelは自動的にHTTPSを提供
- カスタムドメインでも自動的にSSL証明書を発行

### API セキュリティ
- 現在は基本的なバリデーションのみ
- 将来的にレート制限や認証を追加予定

### データ保護
- 個人情報の取り扱いに注意
- 投稿内容は公開されることをユーザーに明示

## コスト管理

### Vercelの料金体系
- Hobbyプラン：無料（制限あり）
- Proプラン：月額$20（制限緩和）
- Enterpriseプラン：カスタム料金

### 使用量の監視
- 「Usage」タブで使用量を確認
- 制限に近づいた場合はアラートが送信

## 今後の拡張計画

### データベースの導入
- PostgreSQL、MongoDB等の選択肢
- Vercel Postgres、PlanetScale等のマネージドサービス

### 認証の強化
- NextAuth.js等の認証ライブラリ
- OAuth連携（Google、GitHub等）

### 監視の強化
- Sentry等のエラー監視サービス
- DataDog等のAPMツール
